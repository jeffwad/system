define("/app/ui/proto",["object","events","iter","/lib/dom"],function(a,b,c){var d=a("object"),e=a("events"),f=a("iter"),g=f.some,h=f.forEach,i=a("/lib/dom").$;b.proto=d.create(e.proto,{init:function(a){return this.uuid=a,this.callProto("init"),this.children=[],this},bubble:function(a){a.phase="bubble",this._fire(a)},capture:function(a){a.phase="capture",this._fire(a)},registerChild:function(a){if(!b.proto.isPrototypeOf(a))throw new TypeError("UI object must implement ui/proto");this.children.push(a)},registerParent:function(a){if(!b.proto.isPrototypeOf(a))throw new TypeError("UI object must implement ui/proto");this.parent=a},render:function(a){if(typeof this.html=="undefined")throw new Error("ui/proto#html has not been set");this.rootNode=document.createElement("div"),this.rootNode.innerHTML=this.html,this.rootNode=i(" > *",this.rootNode)[0],this._renderChildren(),a&&a.appendChild(this.rootNode)},_fire:function(a){var b=a.phase?!1:!0;return this.callProto("_fire",[a]),a.propogationStopped?a:((b||a.phase==="capture")&&g(this.children,function(b){return b.capture(a),a.propogationStopped}),!a.propogationStopped&&(b||a.phase==="bubble")&&this.parent&&this.parent.bubble(a),a)},_renderChildren:function(){var a=this;h(this.children,function(b){var c,d;d=b.region||"default",a.rootNode.getAttribute("data-region")===d?c=a.rootNode:c=i('*[data-region="'+d+'"]',a.rootNode)[0];if(typeof c=="undefined")throw new ReferenceError("ui/proto#render region '"+d+"'' does not exist");b.render(),c.appendChild(b.rootNode)})}})})